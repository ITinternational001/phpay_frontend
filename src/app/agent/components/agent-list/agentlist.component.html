<div class="row">
    <div *ngFor="let data of topData" class="col-lg-3 col-md-3 col-sm-6">
        <app-card [isVisible]="false" [isVisiblebtn]="true" label="{{data.label}}" icon="{{data.icon}}"
            value="{{data.value}}"></app-card>
    </div>
</div>

<div class="card-wrapper">
    <div class="card-header">
        <div class="card-title p-3">{{"listOfAgents" | translate}}</div>
        <div class="card-actions">
            <app-search (search)="onSearch($event)"></app-search>
            <div class="h-divider"></div>
        
            <div *ngIf="isAdmin" class="col-md-12" style="width: 150px; margin-top: -10px;">
                <app-select-search
                    [options]="statusType"
                    placeholder="Select Type"
                    [disabled]="!isReadAndWrite"
                    [showSearch]="false"
                    (optionSelected)="onStatusType()">
                </app-select-search>
            </div>
        
            <div class="h-divider" *ngIf="isAdmin"></div>
        
            <app-button *ngIf="isAdmin"
                [disabled]="!isReadAndWrite"
                [text]="'addNewAgent' | translate"
                [icon]="'fa-plus'"
                [btnClass]="'btn-theme btn-lg'"
                (click)="openForm()">
            </app-button>
        </div>
        
    </div>
    <div class="card-body-table">
        <app-spinner *ngIf="isLoading"></app-spinner>
        <div class="container-with-table">
            <table *ngIf="!isLoading" class="dynastyTable" mat-table [dataSource]="dataSource" matSort>
                <ng-container matColumnDef="agentNumber">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> # </th>
                    <td *matCellDef="let row" mat-cell> {{row.NumberSeries}} </td>
                </ng-container>
                <ng-container matColumnDef="agentId">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> Agent ID </th>
                    <td *matCellDef="let row" mat-cell> {{row.AgentId}} </td>
                </ng-container>
                <ng-container matColumnDef="agentName">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> Agent Name </th>
                    <td *matCellDef="let row" mat-cell> {{row.AgentName}} </td>
                </ng-container>
                <ng-container matColumnDef="userName">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> Username </th>
                    <td *matCellDef="let row" mat-cell> {{row.Username}}</td>
                </ng-container>
                <ng-container matColumnDef="agentType">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> Agent Type </th>
                    <td *matCellDef="let row" mat-cell> {{row.AgentType}} </td>
                </ng-container>
                <ng-container matColumnDef="client">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> No. of Client </th>
                    <td *matCellDef="let row" mat-cell> {{ row.Client}} </td>
                </ng-container>
                <ng-container matColumnDef="downlineAgents">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header> Downline Agents </th>
                    <td *matCellDef="let row" mat-cell> {{row.DownlineAgents}}</td>
                </ng-container>
                <ng-container matColumnDef="walletBalance">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Wallet Balance</th>
                    <td *matCellDef="let row" mat-cell> {{row.WalletBalance | number: '1.2-2'}}</td>
                </ng-container>
             
                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Status </th>
                    <td mat-cell *matCellDef="let row">
                        <span [ngStyle]="row.Status | statusColor">{{ row.Status }}</span> 
                    </td>
                </ng-container>

                <ng-container matColumnDef="action">
                    <th *matHeaderCellDef mat-header-cell mat-sort-header>Action</th>
                    <td *matCellDef="let row" mat-cell>
                        <ng-container>
                            <button [disabled]="!isReadAndWrite" class="btn-theme-vert" mat-mini-fab
                            [matMenuTriggerFor]="menu"><mat-icon>more_vert</mat-icon>
                            </button>
                            <mat-menu #menu="matMenu" xPosition="before">                 
                                <button mat-menu-item (click)="goToProfile(row)">
                                    <span class="fas fa-eye"></span>
                                    <span> {{"viewProfile" | translate}}</span>
                                </button>
                                <button *ngIf="isAdmin" mat-menu-item (click)="openEditForm(row)">
                                    <span class="fas fa-eye"></span>
                                    <span> {{"editDetails" | translate}}</span>
                                </button>
                                <button *ngIf="isAdmin" mat-menu-item (click)="onDisableAgent(row.AgentId)">
                                    <span class="fas fa-eye"></span>
                                    <span> {{ (row.Status == 'Active' ? 'disabled' : 'enabled') | translate }}</span>

                                </button>
                                <button *ngIf="isAdmin" mat-menu-item (click)="openResetPasswordForm(row)">
                                    <span class="fas fa-lock"></span>
                                    <span>{{"resetPassword" | translate}}</span>
                                </button>
                            </mat-menu>
                        </ng-container> 
                    </td>
                </ng-container>

                <tr *matHeaderRowDef="displayedColumns; sticky:true" mat-header-row></tr>
                <tr *matRowDef="let row; columns: displayedColumns" mat-row></tr>
                <!-- Row shown when there is no matching data. -->
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="13" style="text-align: center;">No data matching the filter
                    </td>
                </tr>
            </table>
        </div>
        <app-pagination [totalItems]="totalItems" [itemsPerPage]="itemsPerPage" [currentPage]="currentPage"
            (firstData)="onFirstPage()" (nextData)="onNextPage()" (previousData)="onPreviousPage()"
            (lastData)="onLastPage()" (itemsPerPageChange)="onItemsPerPageChanged($event)">
        </app-pagination>
    </div>
</div>
<div class="card-footer"></div>