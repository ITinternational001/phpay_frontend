"use strict";(self.webpackChunkdynastypay_frontend=self.webpackChunkdynastypay_frontend||[]).push([[52],{7052:(lt,f,i)=>{i.r(f),i.d(f,{MerchantsModule:()=>ct});var g=i(6814),C=i(4828),Z=i(3365),y=i(3566),c=i(5313),N=i(9315),p=i(2096),v=i(7398),T=i(6306),d=i(7700),_=i(7786),t=i(5879),m=i(6223),u=i(4472),U=i(2032),M=i(9157),S=i(8525),x=i(3680);function F(e,a){if(1&e&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n.Id),t.xp6(1),t.Oqu(n.Name)}}function I(e,a){if(1&e&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n.Id),t.xp6(1),t.Oqu(n.Name)}}function Y(e,a){if(1&e&&(t.TgZ(0,"mat-option",15),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.Q6J("value",n.Id),t.xp6(1),t.Oqu(n.Type)}}let A=(()=>{class e{constructor(n,o,s,r,h,l){this._fb=n,this._dialogRef=o,this.data=s,this._vendorService=r,this._merchantService=h,this._clietService=l,this.statusEnum=_.qb,this.merchantForm=this._fb.group({Name:"",Status:"",VendorId:"",ClientId:""})}ngOnInit(){this.getAllClient(),this.getAllVendor(),this.merchantForm.patchValue(this.data)}onFormSubmit(){if(this.data){const n={...this.merchantForm.value,Id:this.data.Id};this.obsMerchantUpdate=this._merchantService.apiMerchantsUpdateMerchantPost(n),this.subsMerchantUpdate=this.obsMerchantUpdate.subscribe({next:o=>{this._dialogRef.close(!0),alert("Data Updated Successfully")},error:o=>{console.log(o)},complete:()=>{}})}else this.obsMerchant=this._merchantService.apiMerchantsCreateMerchantPost(this.merchantForm.value),this.subsMerchant=this.obsMerchant.subscribe({next:n=>{this._dialogRef.close(!0),alert("Data Added Successfully")},error:n=>{console.log(n)},complete:()=>{}})}getAllClient(){this.observable=this._clietService.apiClientGetAllClientsGet(),this.subscription=this.observable.subscribe({next:n=>{this.clientsList=n,console.log(n)},error:n=>{console.log(n)},complete:()=>{}})}getAllVendor(){this.observable=this._vendorService.apiVendorsGetAllVendorsGet(),this.subscription=this.observable.subscribe({next:n=>{this.vendorsList=n},error:n=>{console.log(n)},complete:()=>{}})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(m.qu),t.Y36(d.so),t.Y36(d.WI),t.Y36(u.mq),t.Y36(u.Sg),t.Y36(u.yt))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-merchants-form"]],decls:49,vars:5,consts:[["mat-dialog-title",""],[3,"formGroup","ngSubmit"],["mat-dialog-content",""],[1,"row"],[1,"col-md-6"],["appearance","outline"],["matInput","","placeholder","Ex. Mangopay, Ppay etc.","formControlName","Name"],["formControlName","ClientId"],[3,"value",4,"ngFor","ngForOf"],["formControlName","VendorId"],["formControlName","Status"],[1,"col-md-3"],["mat-dialog-actions",""],["type","button",1,"btn","btn-default"],["type","submit",1,"btn","btn-primary"],[3,"value"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"h1"),t._uU(2,"Merchant Form"),t.qZA()(),t.TgZ(3,"form",1),t.NdJ("ngSubmit",function(){return s.onFormSubmit()}),t.TgZ(4,"div",2)(5,"h2"),t._uU(6,"Add New Merchant"),t.qZA(),t.TgZ(7,"div",3)(8,"div",4)(9,"mat-form-field",5)(10,"mat-label"),t._uU(11,"Merchant name"),t.qZA(),t._UZ(12,"input",6),t.qZA()(),t.TgZ(13,"div",4)(14,"mat-form-field")(15,"mat-label"),t._uU(16,"Client"),t.qZA(),t.TgZ(17,"mat-select",7),t.YNc(18,F,2,2,"mat-option",8),t.qZA()()()(),t.TgZ(19,"div",3)(20,"div",4)(21,"mat-form-field")(22,"mat-label"),t._uU(23,"Vendor"),t.qZA(),t.TgZ(24,"mat-select",9),t.YNc(25,I,2,2,"mat-option",8),t.qZA()()(),t.TgZ(26,"div",4)(27,"mat-form-field")(28,"mat-label"),t._uU(29,"Status"),t.qZA(),t.TgZ(30,"mat-select",10),t.YNc(31,Y,2,2,"mat-option",8),t.qZA()()()(),t.TgZ(32,"h2"),t._uU(33,"Configure Transaction Fee"),t.qZA(),t.TgZ(34,"div",3)(35,"div",4)(36,"h3"),t._uU(37,"Transaction Fee Name"),t.qZA()(),t.TgZ(38,"div",11)(39,"h3"),t._uU(40,"% Fee (atCost)"),t.qZA()(),t.TgZ(41,"div",11)(42,"h3"),t._uU(43,"Fixed Fee (atCost)"),t.qZA()()()(),t.TgZ(44,"div",12)(45,"button",13),t._uU(46,"Cancel"),t.qZA(),t.TgZ(47,"button",14),t._uU(48),t.qZA()()()),2&o&&(t.xp6(3),t.Q6J("formGroup",s.merchantForm),t.xp6(15),t.Q6J("ngForOf",s.clientsList),t.xp6(7),t.Q6J("ngForOf",s.vendorsList),t.xp6(6),t.Q6J("ngForOf",s.statusEnum),t.xp6(17),t.Oqu(s.data?"Update":"Save"))},dependencies:[g.sg,U.Nt,M.KE,M.hX,d.uh,d.xY,d.H8,S.gD,x.ey,m._Y,m.Fj,m.JJ,m.JL,m.sg,m.u]})}return e})();var q=i(617),B=i(2296),D=i(9843);function V(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1," ID "),t.qZA())}function Q(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.Id," ")}}function J(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1," Vendor "),t.qZA())}function G(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.Name," ")}}function O(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1," TotalCashIn "),t.qZA())}function R(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.TotalCashIn," ")}}function w(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1," TotalCashOut "),t.qZA())}function j(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.TotalCashOut," ")}}function $(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Balance "),t.qZA())}function E(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.Balance," ")}}function K(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Status "),t.qZA())}function H(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",1==n.Status?"Active":"Inactive"," ")}}function L(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Vendor "),t.qZA())}function z(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.VendorId," ")}}function P(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Client "),t.qZA())}function X(e,a){if(1&e&&(t.TgZ(0,"td",27),t._uU(1),t.qZA()),2&e){const n=a.$implicit;t.xp6(1),t.hij(" ",n.ClientId," ")}}function W(e,a){1&e&&(t.TgZ(0,"th",26),t._uU(1,"Actions "),t.qZA())}function k(e,a){if(1&e){const n=t.EpF();t.TgZ(0,"td",27)(1,"button",28),t.NdJ("click",function(){const r=t.CHM(n).$implicit,h=t.oxw();return t.KtG(h.openEditForm(r))}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",29)(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function tt(e,a){1&e&&t._UZ(0,"tr",30)}function et(e,a){1&e&&t._UZ(0,"tr",31)}function nt(e,a){1&e&&(t.TgZ(0,"tr",32)(1,"td",33),t._uU(2,"No data matching the filter"),t.qZA()())}const ot=function(){return[5,10,25,100]},at=[{path:"",component:(()=>{class e{constructor(n,o,s,r){this._dialog=n,this._merchantService=o,this._vendorService=s,this._clientService=r,this.statusEnum=_.qb,this.displayedColumns=["Id","Name","TotalCashIn","TotalCashOut","Balance","Status","VendorId","ClientId","Actions"],this.clientsList=[]}ngOnInit(){this.getAllMerchants(),this.getAllClient()}openForm(){this._dialog.open(A,{width:"800px"}).afterClosed().subscribe({next:o=>{o&&this.getAllMerchants()}})}openEditForm(n){this._dialog.open(A,{data:n}).afterClosed().subscribe({next:s=>{s&&this.getAllMerchants()}})}applyFilter(n){this.dataSource.filter=n.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}getAllMerchants(){this.obsMerchant=this._merchantService.apiMerchantsGetAllMerchantsGet(),this.subsMerchant=this.obsMerchant.subscribe({next:n=>{const o=n.map(r=>this.getClientNameById(r.ClientId)),s=n.map(r=>this.getVendorNameById(r.VendorId));(0,N.D)([...o,...s]).subscribe(([...r])=>{const h=n.map((l,b)=>({Id:l.Id,Name:l.Name,TotalCashIn:l.TotalCashIn,TotalCashOut:l.TotalCashOut,Balance:l.Balance,Status:l.Status,VendorId:r[n.length+b],ClientId:r[b]}));this.dataSource=new c.by(h),this.dataSource.sort=this.sort,this.dataSource.paginator=this.paginator})},error:n=>{console.log(n)},complete:()=>{}})}getAllClient(){this.observable=this._clientService.apiClientGetAllClientsGet(),this.subscription=this.observable.subscribe({next:n=>{this.clientsList=n},error:n=>{console.log(n)},complete:()=>{}})}getClientNameById(n){return void 0===n?(0,p.of)("Vendor not Found"):this._clientService.apiClientGetClientByIdGet(n).pipe((0,v.U)(o=>o?.Name??"Client not Found"),(0,T.K)(o=>(console.log(o),(0,p.of)("Client not Found"))))}getVendorNameById(n){return void 0===n?(0,p.of)("Vendor not Found"):this._vendorService.apiVendorsGetVendorByIdGet(n).pipe((0,v.U)(o=>o?.Name??"Vendor not Found"),(0,T.K)(o=>(console.log(o),(0,p.of)("Vendor not Found"))))}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(d.uw),t.Y36(u.Sg),t.Y36(u.mq),t.Y36(u.yt))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-merchants"]],viewQuery:function(o,s){if(1&o&&(t.Gf(Z.NW,5),t.Gf(y.YE,5)),2&o){let r;t.iGM(r=t.CRH())&&(s.paginator=r.first),t.iGM(r=t.CRH())&&(s.sort=r.first)}},decls:45,vars:5,consts:[[1,"card-wrapper"],[1,"card-header"],[1,"card-title"],[1,"card-actions"],[1,"h-divider"],[3,"searchKeyup"],[1,"btn","btn-primary",3,"click"],[1,"card-body"],[1,"mat-elevation-z8"],["mat-table","","matSort","",3,"dataSource"],["matColumnDef","Id"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","Name"],["matColumnDef","TotalCashIn"],["matColumnDef","TotalCashOut"],["matColumnDef","Balance"],["matColumnDef","Status"],["matColumnDef","VendorId"],["matColumnDef","ClientId"],["matColumnDef","Actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["class","mat-row",4,"matNoDataRow"],["aria-label","Select page of users",3,"pageSizeOptions"],[1,"card-footer"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn"],["mat-header-row",""],["mat-row",""],[1,"mat-row"],["colspan","4",1,"mat-cell"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._uU(3,"Merchants "),t.qZA(),t.TgZ(4,"div",3),t._UZ(5,"div",4),t.TgZ(6,"app-search",5),t.NdJ("searchKeyup",function(h){return s.applyFilter(h)}),t.qZA(),t._UZ(7,"div",4),t.TgZ(8,"button",6),t.NdJ("click",function(){return s.openForm()}),t._uU(9,"Add merchant"),t.qZA()()(),t.TgZ(10,"div",7)(11,"div",8)(12,"table",9),t.ynx(13,10),t.YNc(14,V,2,0,"th",11),t.YNc(15,Q,2,1,"td",12),t.BQk(),t.ynx(16,13),t.YNc(17,J,2,0,"th",11),t.YNc(18,G,2,1,"td",12),t.BQk(),t.ynx(19,14),t.YNc(20,O,2,0,"th",11),t.YNc(21,R,2,1,"td",12),t.BQk(),t.ynx(22,15),t.YNc(23,w,2,0,"th",11),t.YNc(24,j,2,1,"td",12),t.BQk(),t.ynx(25,16),t.YNc(26,$,2,0,"th",11),t.YNc(27,E,2,1,"td",12),t.BQk(),t.ynx(28,17),t.YNc(29,K,2,0,"th",11),t.YNc(30,H,2,1,"td",12),t.BQk(),t.ynx(31,18),t.YNc(32,L,2,0,"th",11),t.YNc(33,z,2,1,"td",12),t.BQk(),t.ynx(34,19),t.YNc(35,P,2,0,"th",11),t.YNc(36,X,2,1,"td",12),t.BQk(),t.ynx(37,20),t.YNc(38,W,2,0,"th",11),t.YNc(39,k,7,0,"td",12),t.BQk(),t.YNc(40,tt,1,0,"tr",21),t.YNc(41,et,1,0,"tr",22),t.YNc(42,nt,3,0,"tr",23),t.qZA(),t._UZ(43,"mat-paginator",24),t.qZA()(),t._UZ(44,"div",25),t.qZA()),2&o&&(t.xp6(12),t.Q6J("dataSource",s.dataSource),t.xp6(28),t.Q6J("matHeaderRowDef",s.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",s.displayedColumns),t.xp6(2),t.Q6J("pageSizeOptions",t.DdM(4,ot)))},dependencies:[q.Hw,c.BZ,c.fO,c.as,c.w1,c.Dz,c.nj,c.ge,c.ev,c.XQ,c.Gk,c.Ee,Z.NW,B.RK,D.g]})}return e})()}];let it=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[C.Bz.forChild(at),C.Bz]})}return e})();var st=i(2522),rt=i(2318);let ct=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[g.ez,it,st.M,rt.K]})}return e})()}}]);