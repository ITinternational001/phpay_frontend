"use strict";(self.webpackChunkdynastypay_frontend=self.webpackChunkdynastypay_frontend||[]).push([[62],{5062:(O,g,s)=>{s.r(g),s.d(g,{GoogleAuthModule:()=>C});var d=s(6814),a=s(3969),h=s(5874),t=s(5879),u=s(4472),c=s(4828),p=s(8310),r=s(6223);function m(o,T){if(1&o&&(t.TgZ(0,"div",11),t._UZ(1,"img",12),t.qZA()),2&o){const i=t.oxw();t.xp6(1),t.s9C("src",i.QRCodeUrl,t.LSH)}}const f=[{path:"",component:(()=>{class o{constructor(i,e,n,l){this.otpsService=i,this.router=e,this.notification=n,this.ngZone=l,this.showQr=!0,this.pincode="",this.QRCodeUrl=""}ngOnInit(){(0,h.c)(a.S.getFromToken("OTPIsEnabled"))?this.showQr=!1:(this.onRequestOtp(),this.showQr=!0)}onRequestOtp(){const i={userId:parseInt(a.S.getFromToken("Id")),email:a.S.getFromToken("Email")};this.observableRequest=this.otpsService.apiOtpsGenerateOtpPost(i),this.subscriptionRequest=this.observableRequest.subscribe({next:e=>{null!=e&&(this.QRCodeUrl=e.AuthUrl)},error:e=>{console.log(e)},complete:()=>{}})}onValidateOtp(i){const e={id:parseInt(a.S.getFromToken("Id")),tokenPIN:i};this.observableValidate=this.otpsService.apiOtpsValidateOtpPost(e),this.subscriptionValidate=this.observableValidate.subscribe({next:n=>{n.IsValid&&"1"==sessionStorage.getItem("clientId")?(this.notification.showNotification("OTP was valid, redirecting...","close","success"),this.ngZone.run(()=>{setTimeout(()=>{this.router.navigate(["/admin"])},3e3)})):n.IsValid&&"1"!==sessionStorage.getItem("ClientId")?this.ngZone.run(()=>{setTimeout(()=>{this.router.navigate(["/client"])},3e3)}):this.notification.showNotification("OTP was invalid. Please check the google authenticator","close","error")},error:n=>{this.notification.showNotification(n.error,"close","error"),console.log(n)},complete:()=>{}})}static#t=this.\u0275fac=function(e){return new(e||o)(t.Y36(u.MG),t.Y36(c.F0),t.Y36(p.g),t.Y36(t.R0b))};static#o=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-google-auth"]],decls:16,vars:2,consts:[[1,"login-body"],[1,"container","d-flex","justify-content-center","align-items-center","min-vh-100"],[1,"login-container"],[1,"text-center"],["src","../../assets/dpay_logo.png","alt","Logo",1,"logo","mb-3"],["class","qr",4,"ngIf"],[3,"ngSubmit"],["OtpForm","ngForm"],[1,"form-group","mb-3"],["type","text","id","pincode","name","pincode","required","","placeholder","Enter the Verification Code",1,"form-control","box",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-block"],[1,"qr"],["alt","Logo",1,"logo","mb-3",3,"src"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),t._UZ(4,"img",4),t.TgZ(5,"h2"),t._uU(6,"Authenticator Bind"),t.qZA(),t.TgZ(7,"p"),t._uU(8,"Please Scan the QR Code and Bind"),t.qZA()(),t.YNc(9,m,2,1,"div",5),t.TgZ(10,"form",6,7),t.NdJ("ngSubmit",function(){return n.onValidateOtp(n.pincode)}),t.TgZ(12,"div",8)(13,"input",9),t.NdJ("ngModelChange",function(v){return n.pincode=v}),t.qZA()(),t.TgZ(14,"button",10),t._uU(15,"Submit Verification Code"),t.qZA()()()()()),2&e&&(t.xp6(9),t.Q6J("ngIf",n.showQr),t.xp6(4),t.Q6J("ngModel",n.pincode))},dependencies:[d.O5,r._Y,r.Fj,r.JJ,r.JL,r.Q7,r.On,r.F],styles:[".login-container[_ngcontent-%COMP%]{padding:20px;text-align:center;width:40%}.logo[_ngcontent-%COMP%]{margin-bottom:50px;width:40%}h2[_ngcontent-%COMP%]{font-size:1.5rem;color:#fff;font-weight:700}p[_ngcontent-%COMP%]{font-size:.9rem;color:#fff;margin-bottom:20px}.form-group[_ngcontent-%COMP%]{text-align:left;margin-bottom:15px}.box[_ngcontent-%COMP%]{width:100%;padding:10px;border:1px solid #ccc;border-radius:5px;background:rgba(217,217,217,.7)}button[_ngcontent-%COMP%]{color:#000;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-weight:700;background:linear-gradient(93deg,#977554 0%,#C4986C 25.76%,#F9E8B3 48.9%,#E1B983 74.14%,#977554 100.96%);width:100%}button[_ngcontent-%COMP%]:hover{color:none}input[_ngcontent-%COMP%]{text-align:center}"]})}return o})()}];let b=(()=>{class o{static#t=this.\u0275fac=function(e){return new(e||o)};static#o=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(f),c.Bz]})}return o})(),C=(()=>{class o{static#t=this.\u0275fac=function(e){return new(e||o)};static#o=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[d.ez,b]})}return o})()}}]);